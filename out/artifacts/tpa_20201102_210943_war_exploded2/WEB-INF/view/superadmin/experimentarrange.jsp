<!------------------------------->
<!---- Generated By Denny(luhox@qq.com), cslite for sm -->
<!---- Remarks: ItemListHTML-->
<!---- Date Generated: 2019-06-17 12:23:01-->
<!------------------------------->
<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<c:set var="searchpanel" value="true"></c:set>
<c:set var="uploadfile" value="true"></c:set>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<jsp:include page="../inc/bsa_head.jsp"></jsp:include>
<jsp:include page="../inc/ket.jsp"></jsp:include>
<!-- Custom Styles-->
<link href="bssets/css/bsat1-style.css" rel="stylesheet" />
<title>${pagetitle}-${appName}</title>
</head>
<body>
	<div id="wrapper">
		<jsp:include page="../inc/bsa_navtop.jsp"></jsp:include>
		<!--/. NAV TOP  -->
		<jsp:include page="../inc/bsa_navside.jsp"></jsp:include>
		<!-- /. NAV SIDE  -->
		<div id="page-wrapper">
			<div class="header">
				<h3 class="page-header">
					${pagetitle} <small>${subtitle}</small>
				</h3>
			</div>
			<div id="page-inner">
				<!-- content start -->
				<c:choose>
					<c:when test="${operate == null}">

						<!-- div Tables -->
						<div class="panel panel-default">
							<jsp:include page="../inc/pager.jsp"></jsp:include>
							<!-- div表格  (中大屏幕，表格显示) begin -->
							<!-- Advanced Tables -->
							<div
								class="panel panel-default  visible-md-block visible-lg-block">
								<!-- <div class="panel-heading">${tabletitle}</div> -->
								<div class="row">
									<div class="col-md-12">
										<div class="panel-body">
											<div class="table-responsive">
												<table
													class="table table-striped table-bordered table-hover"
													id="dataTables-example">
													<thead>
														<tr class="bg-blue">
															<th>序号</th>
															<th>学科</th>
															<th>班级</th>
															<th>教师</th>
															<th>学期编号</th>
															<th>开通状态</th>
														</tr>
													</thead>
													<tbody>
														<c:forEach var="it" items="${list}" varStatus="index">
															<tr>
																<td id="t${it.curriculum.id}">${index.count+(pager.current - 1) * pager.size}</td>
																<td>${it.curriculum.subject_name}</td>
																<td>${it.curriculum.student_group_name}</td>
																<td>${it.curriculum.user_name}</td>
																<td>${it.curriculum.semester}</td>
																<td><c:choose>
																		<c:when test="${it.curriculum.is_actived}">
																			<img alt="" src="bssets/i/greendot.png">
																		</c:when>
																		<c:when test="${it.curriculum.is_actived==false}">
																			<img alt="" src="bssets/i/reddot.png">
																		</c:when>
																	</c:choose></td>
															</tr>
															<tr>
																<td colspan="6">
																	<div>
																		实验详情 <a
																			href="${pagename}?operate=additem&id=${it.curriculum.id}&sid=${it.curriculum.subject_id}"
																			class="btn btn-info">增加一个实验</a>
																	</div>
																	<table
																		class="table table-striped table-bordered table-hover">
																		<thead>
																			<tr class="bg-seagreen">
																				<th>序号</th>
																				<th>实验标题</th>
																				<th>实验时间</th>
																				<th>文件大小</th>
																				<th>操作</th>
																			</tr>
																		</thead>
																		<c:forEach var="exp" items="${it.experimentlist}"
																			varStatus="j">
																			<tr>
																				<td>${j.count}</td>
																				<td>${exp.experiment_title}</td>
																				<td><c:if test="${exp.opening_gmt !=0}">
																						<fmt:formatDate pattern="yyyy-MM-dd"
																							value="${exp.opening_gmt_date}" />
																					</c:if>~<c:if test="${exp.closing_gmt !=0}">
																						<fmt:formatDate pattern="yyyy-MM-dd"
																							value="${exp.closing_gmt_date}" />
																					</c:if> <c:choose>
																						<c:when test="${now <exp.closing_gmt}">
																							<img alt="" src="bssets/i/greendot.png">
																						</c:when>
																						<c:when test="${now >exp.closing_gmt}">
																							<img alt="" src="bssets/i/reddot.png">
																						</c:when>
																					</c:choose></td>
																				<td>${exp.filesize/1000000}MB</td>
																				<td><c:choose>
																						<c:when
																							test="${exp.experiment_curriculum_is_actived}">
																							<a
																								href="${pagename}?operate=hideitem&id=${exp.id}"
																								class="btn btn-warning">关闭</a>
																						</c:when>
																						<c:when
																							test="${!exp.experiment_curriculum_is_actived}">
																							<a
																								href="${pagename}?operate=showitem&id=${exp.id}"
																								class="btn btn-info">开通</a>
																						</c:when>
																					</c:choose> <a
																					href="${pagename}?operate=edititem&id=${exp.id}"
																					class="btn btn-success">编辑</a></td>
																			</tr>
																		</c:forEach>
																	</table>

																</td>
															</tr>
														</c:forEach>
													</tbody>
												</table>
											</div>
										</div>
									</div>
								</div>
							</div>
							<!--End Advanced Tables -->
							<!-- div表格  (中大屏幕，表格显示) end -->
							<!-- div表格  (小屏幕，类卡片显示) begin -->
							<div class="panel-body visible-xs-block visible-sm-block">
								<div class="row">
									<c:forEach var="it" items="${list}" varStatus="index">
										<div class="col-xs-12 col-sm-6">
											<div class="row showbd margin-xs">
												<div class="col-xs-12 col-sm-12 bg-primary padding-xs"
													id="t${it.curriculum.id}">
													<h3>${index.count+(pager.current - 1) * pager.size}</h3>
												</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.id}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.subject_id}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.student_group_id}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.user_id}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.semester}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.is_actived}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.subject_name}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.student_group_name}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">${it.curriculum.user_name}</div>
												<div class="clearfix"></div>

												<div class="col-xs-12 col-sm-12">
													<button value="${it.curriculum.id}"
														class="moveup btn btn-info"
														<c:if test="${index.count==1}">disabled</c:if>>上移</button>
													<button value="${it.curriculum.id}"
														class="movedown btn btn-warning"
														<c:if test="${index.count==pager.total}">disabled</c:if>>下移</button>
													<button value="${it.curriculum.id}"
														class="edititem btn btn-success">编辑</button>
													<button value="${it.curriculum.id}"
														class="deleteitem btn btn-danger">删除</button>
												</div>
											</div>
										</div>
									</c:forEach>
								</div>
							</div>
							<!-- div表格  (小屏幕，类卡片显示) end -->
						</div>
						<!--End div Tables -->
					</c:when>
					<c:when test="${operate == 'additem'}">
						<div class="row">
							<div class="col-xs-12">
								<div class="panel panel-default">
									<div class="panel-heading">
										<div class="card-title">
											<div class="title">${formtitle}</div>
										</div>
									</div>
									<div class="panel-body">
										<a class="btn btn-warning" href="${pagename}">放弃保存，直接返回</a>
										<form id="form1" class="form-horizontal" method="post"
											action="${pagename}">
											<input type="hidden" name="operate" value="addform" /> <input
												type="hidden" name="curriculum_id" value="${param.id}" /> <input
												type="hidden" name="subject_id" value="${param.sid}" /> <input
												type="hidden" name="referer" value="${referer}" />
											<div class="form-group">
												<div class="col-sm-10">
													正在添加实验的课程：${curriculum.subject_name}-${curriculum.student_group_name}
												</div>
											</div>
											<div class="form-group">
												<label for="title" class="col-sm-2 control-label">实验标题</label>
												<div class="col-sm-10">
													<input type="text" class="form-control" id="title"
														name="title" placeholder="实验标题" >
												</div>
											</div>
											<div class="form-group d_t_dater">
												<label for="opening_date" class="col-sm-2 control-label">开始时间</label>
												<div class="col-sm-10">
													<div class="input-group">
														<span class="input-group-addon" style="cursor: pointer;"
															onclick="$.jeDate('#opening_date',{trigger:false,format: 'YYYY-MM-DD hh:mm:ss'})"></span>
														<input placeholder="" type="text" class="form-control"
															id="opening_gmt_date" name="opening_gmt_date"
															value="<fmt:formatDate pattern='yyyy-MM-dd HH:mm:ss' value='${opening_gmt_date}' />"
															readonly>
													</div>
												</div>
											</div>
											<div class="form-group d_t_dater">
												<label for="closing_date" class="col-sm-2 control-label">截止时间</label>
												<div class="col-sm-10">
													<div class="input-group">
														<span class="input-group-addon" style="cursor: pointer;"
															onclick="$.jeDate('#closing_date',{trigger:false,format: 'YYYY-MM-DD hh:mm:ss'})"></span>
														<input placeholder="" type="text" class="form-control"
															id="closing_gmt_date" name="closing_gmt_date"
															value="<fmt:formatDate pattern='yyyy-MM-dd HH:mm:ss' value='${closing_gmt_date}' />"
															readonly>
													</div>
												</div>
											</div>
											<div class="form-group">
												<label for="intro" class="col-sm-2 control-label">实验简介</label>
												<div class="col-sm-10">
													<input type="text" class="form-control" id="intro"
														name="intro" placeholder="">
												</div>
											</div>
											<div class="form-group">
												<label for="filesize" class="col-sm-2 control-label">文件大小</label>
												<div class="col-sm-4">
													<input type="text" class="form-control restrictnumber"
														id="filesize" name="filesize" placeholder="文件大小"
														value="2000000">
												</div>
												<div class="col-sm-2">
													<span class="form-control text-left hideborder">Byte</span>
												</div>
												<div class="col-sm-4">
													<span id="filesizemb" class="form-control"><fmt:formatNumber
															value="${2000000/1024/1024}" type="number" pattern="0.00"
															maxFractionDigits="2" />MB</span>
												</div>
											</div>
											<div class="form-group">
												<label for="purposes_requirement"
													class="col-sm-2 control-label">实验目的及要求</label>
												<div class="col-sm-10">
													<textarea class="form-control" id="purposes_requirement"
														name="purposes_requirement"
														style="width: 100%; height: 300px; visibility: hidden;">${it.purposes_requirement}</textarea>
												</div>
											</div>
											<div class="form-group">
												<label for="content" class="col-sm-2 control-label">实验内容</label>
												<div class="col-sm-10">
													<textarea class="form-control" id="content" name="content"
														style="width: 100%; height: 300px; visibility: hidden;">${it.content}</textarea>
												</div>
											</div>


											<div class="form-group">
												<div class="col-sm-offset-2 col-sm-10">
													<button type="submit" class="btn btn-success">更新</button>
												</div>
											</div>
										</form>
									</div>
								</div>
							</div>
						</div>
					</c:when>
					<c:when test="${operate == 'edititem'}">
						<div class="row">
							<div class="col-xs-12">
								<div class="panel panel-default">
									<div class="panel-heading">
										<div class="card-title">
											<div class="title">${formtitle}</div>
										</div>
									</div>
									<div class="panel-body">
										<a class="btn btn-warning" href="${pagename}">放弃保存，直接返回</a>
										<form id="form1" class="form-horizontal" method="post"
											action="${pagename}">
											<input type="hidden" name="operate" value="editform" /> <input
												type="hidden" name="experiment_id" value="${it.id}" /> <input
												type="hidden" name="lec_id" value="${lec.id}" /> <input
												type="hidden" name="referer" value="${referer}" />

											<div class="form-group">
												<label for="title" class="col-sm-2 control-label">实验标题</label>
												<div class="col-sm-10">
													<input type="text" class="form-control" id="title"
														name="title" placeholder="实验标题" value="${it.title}">
												</div>
											</div>
											<div class="form-group d_t_dater">
												<label for="opening_date" class="col-sm-2 control-label">开始时间</label>
												<div class="col-sm-10">
													<div class="input-group">
														<span class="input-group-addon" style="cursor: pointer;"
															onclick="$.jeDate('#opening_date',{trigger:false,format: 'YYYY-MM-DD hh:mm:ss'})"></span>
														<input placeholder="" type="text" class="form-control"
															id="opening_gmt_date" name="opening_gmt_date"
															<c:if test="${lec.opening_gmt != 0}">
	value="<fmt:formatDate pattern='yyyy-MM-dd HH:mm:ss' value='${lec.opening_gmt_date}' />"
	</c:if>
															readonly>
													</div>
												</div>
											</div>
											<div class="form-group d_t_dater">
												<label for="closing_date" class="col-sm-2 control-label">截止时间</label>
												<div class="col-sm-10">
													<div class="input-group">
														<span class="input-group-addon" style="cursor: pointer;"
															onclick="$.jeDate('#closing_date',{trigger:false,format: 'YYYY-MM-DD hh:mm:ss'})"></span>
														<input placeholder="" type="text" class="form-control"
															id="closing_gmt_date" name="closing_gmt_date"
															<c:if test="${lec.closing_gmt != 0}">
	value="<fmt:formatDate pattern='yyyy-MM-dd HH:mm:ss' value='${lec.closing_gmt_date}' />"
	</c:if>
															readonly>
													</div>
												</div>
											</div>
											<div class="form-group">
												<label for="intro" class="col-sm-2 control-label">实验简介</label>
												<div class="col-sm-10">
													<input type="text" class="form-control" id="intro"
														name="intro" placeholder="" value="${it.intro}">
												</div>
											</div>
											<div class="form-group">
												<label for="filesize" class="col-sm-2 control-label">文件大小</label>
												<div class="col-sm-4">
													<input type="text" class="form-control restrictnumber"
														id="filesize" name="filesize" placeholder="文件大小"
														value="${it.filesize}">
												</div>
												<div class="col-sm-2">
													<span class="form-control text-left hideborder">Byte</span>
												</div>
												<div class="col-sm-4">
													<span id="filesizemb" class="form-control"><fmt:formatNumber
															value="${it.filesize/1024/1024}" type="number"
															pattern="0.00" maxFractionDigits="2" />MB</span>
												</div>
											</div>
											<div class="form-group">
												<label for="purposes_requirement"
													class="col-sm-2 control-label">实验目的及要求</label>
												<div class="col-sm-10">
													<textarea class="form-control" id="purposes_requirement"
														name="purposes_requirement"
														style="width: 100%; height: 300px; visibility: hidden;">${it.purposes_requirement}</textarea>
												</div>
											</div>
											<div class="form-group">
												<label for="content" class="col-sm-2 control-label">实验内容</label>
												<div class="col-sm-10">
													<textarea class="form-control" id="content" name="content"
														style="width: 100%; height: 300px; visibility: hidden;">${it.content}</textarea>
												</div>
											</div>


											<div class="form-group">
												<div class="col-sm-offset-2 col-sm-10">
													<button type="submit" class="btn btn-success">更新</button>
												</div>
											</div>
										</form>
									</div>
								</div>
							</div>
						</div>
					</c:when>
				</c:choose>
				<!-- content end -->
				<jsp:include page="../inc/bsa_foot.jsp"></jsp:include>
			</div>
			<!-- /. PAGE INNER  -->
		</div>
	</div>
	<c:if test="${operate != null}">
		<script type="text/javascript" src="bssets/jedate/jquery.jedate.js"></script>
		<script type="text/javascript">
			$(document).ready(function() {
				//------------
				$("#opening_gmt_date").jeDate({
					format : "YYYY-MM-DD hh:mm:ss"
				});
				$("#closing_gmt_date").jeDate({
					format : "YYYY-MM-DD hh:mm:ss"
				});
				//------------
				$("#filesize").keyup(function(){
					//alert("filesize="+$("#filesize").val());
					var filesize=$("#filesize").val();
					var result=Math.round(filesize/1024/1024*100)/100;
					$("#filesizemb").html(result+"MB");
				});
				$("#form1").submit(function(e) {
					if ($("#title").val() == '') {
						alert("实验标题必须输入哈！"+$("#title").val());
						$("#title").focus();
						return false;
					}
					if ($("#intro").val() == '') {
						alert("实验简介必须输入！");
						$("#intro").focus();
						return false;
					}					
					if ($("#filesize").val() == '') {
						alert("文件大小必须输入！");
						$("#filesize").focus();
						return false;
					}
				});
				KindEditor
				.ready(function(K) {
					var editor1 = K
							.create(
									'textarea[name="content"]',
									{
										cssPath : '${basePath}bssets/ket/plugins/code/prettify.css',
										uploadJson : '${basePath}superadmin/uploadfile?category=article',
										fileManagerJson : '${basePath}superadmin/filemanager',
										allowFileManager : true,
										afterCreate : function() {
										}
									});
					//purposes_requirement
					var editor2 = K
					.create(
							'textarea[name="purposes_requirement"]',
							{
								cssPath : '${basePath}bssets/ket/plugins/code/prettify.css',
								uploadJson : '${basePath}superadmin/uploadfile?category=article',
								fileManagerJson : '${basePath}superadmin/filemanager',
								allowFileManager : true,
								afterCreate : function() {
								}
							});
				});
			});
		</script>
	</c:if>
	<c:if test="${operate == null}">
		<script type="text/javascript">
			
		</script>
	</c:if>
</body>
</html>


